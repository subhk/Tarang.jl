<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>GPU API Reference · Tarang.jl</title><meta name="title" content="GPU API Reference · Tarang.jl"/><meta property="og:title" content="GPU API Reference · Tarang.jl"/><meta property="twitter:title" content="GPU API Reference · Tarang.jl"/><meta name="description" content="Documentation for Tarang.jl."/><meta property="og:description" content="Documentation for Tarang.jl."/><meta property="twitter:description" content="Documentation for Tarang.jl."/><meta property="og:url" content="https://subhk.github.io/Tarang.jl/api/gpu/"/><meta property="twitter:url" content="https://subhk.github.io/Tarang.jl/api/gpu/"/><link rel="canonical" href="https://subhk.github.io/Tarang.jl/api/gpu/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Tarang.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Tarang.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Installing Tarang</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../getting_started/installation/">Installation</a></li><li><a class="tocitem" href="../../getting_started/first_steps/">First Steps with Tarang.jl</a></li><li><a class="tocitem" href="../../getting_started/running_with_mpi/">Running with MPI</a></li><li><a class="tocitem" href="../../pages/configuration/">Configuration</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials &amp; Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Tutorial Notebooks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/overview/">Tutorials Overview</a></li><li><a class="tocitem" href="../../tutorials/ivp_2d_rbc/">Tutorial: 2D Rayleigh-Bénard Convection</a></li><li><a class="tocitem" href="../../tutorials/ivp_3d_turbulence/">Tutorial: 3D Turbulence Simulation</a></li><li><a class="tocitem" href="../../tutorials/boundary_conditions/">Tutorial: Boundary Conditions</a></li><li><a class="tocitem" href="../../tutorials/analysis_and_output/">Tutorial: Analysis and Output</a></li><li><a class="tocitem" href="../../tutorials/eigenvalue_problems/">Tutorial: Eigenvalue Problems</a></li><li><a class="tocitem" href="../../tutorials/surface_dynamics/">Surface and Boundary Dynamics</a></li><li><a class="tocitem" href="../../tutorials/rotating_shallow_water/">Rotating Shallow Water with Lagrangian Averaging</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Example Scripts</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/gallery/">Example Gallery</a></li><li><a class="tocitem" href="../../examples/fluid_dynamics/">Fluid Dynamics Examples</a></li><li><a class="tocitem" href="../../examples/heat_transfer/">Heat Transfer Examples</a></li><li><a class="tocitem" href="../../examples/eigenvalue_analysis/">Eigenvalue Analysis Examples</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Jupyter Notebooks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../notebooks/rayleigh_benard/">Notebook: Rayleigh-Bénard Convection</a></li><li><a class="tocitem" href="../../notebooks/channel_flow/">Notebook: Channel Flow</a></li><li><a class="tocitem" href="../../notebooks/taylor_green/">Notebook: Taylor-Green Vortex</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">User Guide</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Core Concepts</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../pages/coordinates/">Coordinates</a></li><li><a class="tocitem" href="../../pages/bases/">Spectral Bases</a></li><li><a class="tocitem" href="../../pages/domains/">Domains</a></li><li><a class="tocitem" href="../../pages/fields/">Fields</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Problem Setup</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../pages/operators/">Operators</a></li><li><a class="tocitem" href="../../pages/problems/">Problems</a></li><li><a class="tocitem" href="../../pages/solvers/">Solvers</a></li><li><a class="tocitem" href="../../pages/timesteppers/">Time Steppers</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Physics &amp; Modeling</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../pages/stochastic_forcing/">Stochastic Forcing</a></li><li><a class="tocitem" href="../../pages/temporal_filters/">Temporal Filters for Lagrangian Averaging</a></li><li><a class="tocitem" href="../../pages/les_models/">Large Eddy Simulation (LES) Models</a></li><li><a class="tocitem" href="../../pages/gql_approximation/">Generalized Quasi-Linear (GQL) Approximation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Performance &amp; Parallelism</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../pages/gpu_computing/">GPU Computing</a></li><li><a class="tocitem" href="../../pages/parallelism/">Parallelism</a></li><li><a class="tocitem" href="../../pages/optimization/">Performance Optimization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Analysis &amp; Output</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../pages/analysis/">Analysis</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-6" type="checkbox"/><label class="tocitem" for="menuitem-4-6"><span class="docs-label">Advanced Topics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../pages/tau_method/">The Tau Method for Boundary Conditions</a></li><li><a class="tocitem" href="../../pages/custom_operators/">Custom Operators</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox" checked/><label class="tocitem" for="menuitem-5"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-5-1" type="checkbox"/><label class="tocitem" for="menuitem-5-1"><span class="docs-label">Core</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../coordinates/">Coordinates API</a></li><li><a class="tocitem" href="../bases/">Bases API</a></li><li><a class="tocitem" href="../domains/">Domains API</a></li><li><a class="tocitem" href="../fields/">Fields API</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Operators &amp; Problems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../operators/">Operators API</a></li><li><a class="tocitem" href="../problems/">Problems API</a></li><li><a class="tocitem" href="../solvers/">Solvers API</a></li><li><a class="tocitem" href="../timesteppers/">Timesteppers API</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox" checked/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">GPU &amp; Performance</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>GPU API Reference</a><ul class="internal"><li><a class="tocitem" href="#Architecture-Types"><span>Architecture Types</span></a></li><li><a class="tocitem" href="#Array-Operations"><span>Array Operations</span></a></li><li><a class="tocitem" href="#Transform-Functions"><span>Transform Functions</span></a></li><li><a class="tocitem" href="#GPU-Kernels"><span>GPU Kernels</span></a></li><li><a class="tocitem" href="#Memory-Management"><span>Memory Management</span></a></li><li><a class="tocitem" href="#Stream-Management"><span>Stream Management</span></a></li><li><a class="tocitem" href="#FFT-Plans"><span>FFT Plans</span></a></li><li><a class="tocitem" href="#KernelOperation"><span>KernelOperation</span></a></li><li><a class="tocitem" href="#Distributed-GPU"><span>Distributed GPU</span></a></li><li><a class="tocitem" href="#Configuration"><span>Configuration</span></a></li><li><a class="tocitem" href="#Cache-Management"><span>Cache Management</span></a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-4" type="checkbox"/><label class="tocitem" for="menuitem-5-4"><span class="docs-label">Extras</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../stochastic_forcing/">Stochastic Forcing API</a></li><li><a class="tocitem" href="../les_models/">LES Models API</a></li><li><a class="tocitem" href="../analysis/">Analysis API</a></li><li><a class="tocitem" href="../io/">I/O API</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Development</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../pages/contributing/">Contributing</a></li><li><a class="tocitem" href="../../pages/architecture/">Architecture</a></li><li><a class="tocitem" href="../../pages/testing/">Testing</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Reference</a></li><li><a class="is-disabled">GPU &amp; Performance</a></li><li class="is-active"><a href>GPU API Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>GPU API Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/subhk/Tarang.jl/blob/main/docs/src/api/gpu.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="GPU-API-Reference"><a class="docs-heading-anchor" href="#GPU-API-Reference">GPU API Reference</a><a id="GPU-API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#GPU-API-Reference" title="Permalink"></a></h1><p>This page documents the GPU-specific functions and types in Tarang.jl.</p><h2 id="Architecture-Types"><a class="docs-heading-anchor" href="#Architecture-Types">Architecture Types</a><a id="Architecture-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Architecture-Types" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Tarang.GPU"><a class="docstring-binding" href="#Tarang.GPU"><code>Tarang.GPU</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">GPU &lt;: AbstractSerialArchitecture</code></pre><p>GPU architecture using CUDA.jl for NVIDIA GPUs. Requires CUDA.jl to be loaded for full functionality.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">using CUDA  # Must load CUDA first
arch = GPU()
dist = Distributor(coordsys; architecture=arch)</code></pre><p><strong>Notes</strong></p><ul><li>GPU support is optional and loaded via package extension</li><li>If CUDA.jl is not available, GPU() will throw an error</li><li>For multi-GPU, use with MPI (one GPU per MPI rank)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/Tarang.jl/blob/30251ba6399d28608799cf65eb9c7c0739112b4a/src/core/architectures.jl#L91-L108">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Tarang.CPU"><a class="docstring-binding" href="#Tarang.CPU"><code>Tarang.CPU</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">CPU &lt;: AbstractSerialArchitecture</code></pre><p>CPU architecture using Julia&#39;s native arrays and threading. This is the default architecture.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">arch = CPU()
dist = Distributor(coordsys; architecture=arch)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/Tarang.jl/blob/30251ba6399d28608799cf65eb9c7c0739112b4a/src/core/architectures.jl#L49-L60">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Tarang.AbstractArchitecture"><a class="docstring-binding" href="#Tarang.AbstractArchitecture"><code>Tarang.AbstractArchitecture</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">AbstractArchitecture</code></pre><p>Abstract supertype for all compute architectures.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/Tarang.jl/blob/30251ba6399d28608799cf65eb9c7c0739112b4a/src/core/architectures.jl#L31-L35">source</a></section></details></article><h2 id="Array-Operations"><a class="docs-heading-anchor" href="#Array-Operations">Array Operations</a><a id="Array-Operations-1"></a><a class="docs-heading-anchor-permalink" href="#Array-Operations" title="Permalink"></a></h2><h3 id="Data-Movement"><a class="docs-heading-anchor" href="#Data-Movement">Data Movement</a><a id="Data-Movement-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Movement" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Move array to GPU
gpu_array = on_architecture(GPU(), cpu_array)

# Move array to CPU
cpu_array = on_architecture(CPU(), gpu_array)

# Check if array is on GPU
is_gpu_array(array)</code></pre><h3 id="Allocation"><a class="docs-heading-anchor" href="#Allocation">Allocation</a><a id="Allocation-1"></a><a class="docs-heading-anchor-permalink" href="#Allocation" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Allocate on specific architecture
zeros(GPU(), Float64, 128, 128)
ones(GPU(), Float32, 256)
similar(gpu_array)</code></pre><h2 id="Transform-Functions"><a class="docs-heading-anchor" href="#Transform-Functions">Transform Functions</a><a id="Transform-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Transform-Functions" title="Permalink"></a></h2><h3 id="FFT-Control"><a class="docs-heading-anchor" href="#FFT-Control">FFT Control</a><a id="FFT-Control-1"></a><a class="docs-heading-anchor-permalink" href="#FFT-Control" title="Permalink"></a></h3><table><tr><th style="text-align: right">Function</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right"><code>set_gpu_fft_mode!(field, mode)</code></td><td style="text-align: right">Set FFT backend (<code>:auto</code>, <code>:cpu</code>, <code>:gpu</code>)</td></tr><tr><td style="text-align: right"><code>set_gpu_fft_min_elements!(n)</code></td><td style="text-align: right">Threshold for auto mode</td></tr><tr><td style="text-align: right"><code>should_use_gpu_fft(field)</code></td><td style="text-align: right">Check if GPU FFT will be used</td></tr></table><h3 id="Transform-Execution"><a class="docs-heading-anchor" href="#Transform-Execution">Transform Execution</a><a id="Transform-Execution-1"></a><a class="docs-heading-anchor-permalink" href="#Transform-Execution" title="Permalink"></a></h3><table><tr><th style="text-align: right">Function</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right"><code>forward_transform!(field)</code></td><td style="text-align: right">Forward spectral transform</td></tr><tr><td style="text-align: right"><code>backward_transform!(field)</code></td><td style="text-align: right">Backward spectral transform</td></tr><tr><td style="text-align: right"><code>gpu_forward_transform!(field)</code></td><td style="text-align: right">Force GPU transform</td></tr><tr><td style="text-align: right"><code>gpu_backward_transform!(field)</code></td><td style="text-align: right">Force GPU transform</td></tr></table><h2 id="GPU-Kernels"><a class="docs-heading-anchor" href="#GPU-Kernels">GPU Kernels</a><a id="GPU-Kernels-1"></a><a class="docs-heading-anchor-permalink" href="#GPU-Kernels" title="Permalink"></a></h2><h3 id="Element-wise-Operations"><a class="docs-heading-anchor" href="#Element-wise-Operations">Element-wise Operations</a><a id="Element-wise-Operations-1"></a><a class="docs-heading-anchor-permalink" href="#Element-wise-Operations" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Basic operations
gpu_add!(c, a, b)           # c = a + b
gpu_sub!(c, a, b)           # c = a - b
gpu_mul!(c, a, b)           # c = a .* b
gpu_scale!(y, α, x)         # y = α * x
gpu_axpy!(y, α, x)          # y = y + α * x

# Linear combinations
gpu_linear_combination!(y, α, a, β, b)  # y = α*a + β*b
gpu_axpby!(y, α, x, β)                  # y = α*x + β*y</code></pre><h3 id="Timestepping-Kernels"><a class="docs-heading-anchor" href="#Timestepping-Kernels">Timestepping Kernels</a><a id="Timestepping-Kernels-1"></a><a class="docs-heading-anchor-permalink" href="#Timestepping-Kernels" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Runge-Kutta stage update
gpu_rk_stage!(u_new, u, k, dt, coeff)

# Fused multiply-add
gpu_fma!(y, a, b, c)  # y = a*b + c</code></pre><h3 id="Physics-Kernels"><a class="docs-heading-anchor" href="#Physics-Kernels">Physics Kernels</a><a id="Physics-Kernels-1"></a><a class="docs-heading-anchor-permalink" href="#Physics-Kernels" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Kinetic energy
gpu_kinetic_energy_2d!(ke, ux, uy)
gpu_kinetic_energy_3d!(ke, ux, uy, uz)

# Gradient magnitude squared
gpu_grad_mag_sq_2d!(result, fx, fy)

# Viscous damping in spectral space
gpu_viscous_damping!(field, ν, k2)

# Dealiasing
gpu_dealias_multiply!(result, a, b, mask)
gpu_triple_product!(result, a, b, c)</code></pre><h3 id="Complex-Operations"><a class="docs-heading-anchor" href="#Complex-Operations">Complex Operations</a><a id="Complex-Operations-1"></a><a class="docs-heading-anchor-permalink" href="#Complex-Operations" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Complex conjugate multiply
gpu_conj_multiply!(c, a, b)  # c = conj(a) * b

# Squared magnitude
gpu_squared_magnitude!(result, z)  # result = |z|²</code></pre><h2 id="Memory-Management"><a class="docs-heading-anchor" href="#Memory-Management">Memory Management</a><a id="Memory-Management-1"></a><a class="docs-heading-anchor-permalink" href="#Memory-Management" title="Permalink"></a></h2><h3 id="Memory-Pool"><a class="docs-heading-anchor" href="#Memory-Pool">Memory Pool</a><a id="Memory-Pool-1"></a><a class="docs-heading-anchor-permalink" href="#Memory-Pool" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Pool statistics
stats = memory_pool_stats()

# Clear cached memory
clear_memory_pool!()

# Allocate from pool
buffer = pool_allocate(Float64, 1024)
pool_release!(buffer)</code></pre><h3 id="Pinned-Memory"><a class="docs-heading-anchor" href="#Pinned-Memory">Pinned Memory</a><a id="Pinned-Memory-1"></a><a class="docs-heading-anchor-permalink" href="#Pinned-Memory" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Get pinned buffer for async transfers
buffer = get_pinned_buffer(Float64, size)

# Async copy operations
async_copy_to_gpu!(gpu_dest, pinned_src)
async_copy_to_cpu!(pinned_dest, gpu_src)</code></pre><h3 id="Memory-Info"><a class="docs-heading-anchor" href="#Memory-Info">Memory Info</a><a id="Memory-Info-1"></a><a class="docs-heading-anchor-permalink" href="#Memory-Info" title="Permalink"></a></h3><pre><code class="language-julia hljs"># GPU memory status
info = gpu_memory_info()
# Returns: (free_bytes, total_bytes, used_bytes)

# Check if allocation is possible
can_alloc = check_gpu_memory(required_bytes)</code></pre><h2 id="Stream-Management"><a class="docs-heading-anchor" href="#Stream-Management">Stream Management</a><a id="Stream-Management-1"></a><a class="docs-heading-anchor-permalink" href="#Stream-Management" title="Permalink"></a></h2><pre><code class="language-julia hljs"># Get dedicated streams
compute_stream = get_compute_stream()
transfer_stream = get_transfer_stream()

# Synchronize all streams
sync_streams!()</code></pre><h2 id="FFT-Plans"><a class="docs-heading-anchor" href="#FFT-Plans">FFT Plans</a><a id="FFT-Plans-1"></a><a class="docs-heading-anchor-permalink" href="#FFT-Plans" title="Permalink"></a></h2><h3 id="Standard-FFT-Plans"><a class="docs-heading-anchor" href="#Standard-FFT-Plans">Standard FFT Plans</a><a id="Standard-FFT-Plans-1"></a><a class="docs-heading-anchor-permalink" href="#Standard-FFT-Plans" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Create GPU FFT plan
plan = plan_gpu_fft(arch, size, eltype)

# Execute transforms
gpu_forward_fft!(output, input, plan)
gpu_backward_fft!(output, input, plan)

# Async FFT
gpu_fft_async!(output, input, plan, stream)</code></pre><h3 id="Batched-FFT"><a class="docs-heading-anchor" href="#Batched-FFT">Batched FFT</a><a id="Batched-FFT-1"></a><a class="docs-heading-anchor-permalink" href="#Batched-FFT" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Create batched plan
plan = plan_batched_gpu_fft(arch, batch_size, fft_size, eltype)

# Execute batched transforms
batched_fft!(output, input, plan)
batched_ifft!(output, input, plan)</code></pre><h3 id="DCT-Plans-(Chebyshev)"><a class="docs-heading-anchor" href="#DCT-Plans-(Chebyshev)">DCT Plans (Chebyshev)</a><a id="DCT-Plans-(Chebyshev)-1"></a><a class="docs-heading-anchor-permalink" href="#DCT-Plans-(Chebyshev)" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Create DCT plan for specific dimension
plan = plan_gpu_dct_dim(arch, full_size, eltype, dim)

# Execute DCT
gpu_dct_dim!(output, input, plan, Val(:forward))
gpu_dct_dim!(output, input, plan, Val(:backward))</code></pre><h3 id="Mixed-Transform-Plans"><a class="docs-heading-anchor" href="#Mixed-Transform-Plans">Mixed Transform Plans</a><a id="Mixed-Transform-Plans-1"></a><a class="docs-heading-anchor-permalink" href="#Mixed-Transform-Plans" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Create mixed Fourier-Chebyshev plan
plan = plan_gpu_mixed_transform(arch, bases, size)

# Execute mixed transforms
gpu_mixed_forward_transform!(output, input, plan)
gpu_mixed_backward_transform!(output, input, plan)</code></pre><h2 id="KernelOperation"><a class="docs-heading-anchor" href="#KernelOperation">KernelOperation</a><a id="KernelOperation-1"></a><a class="docs-heading-anchor-permalink" href="#KernelOperation" title="Permalink"></a></h2><p>Portable kernel wrapper for CPU/GPU:</p><pre><code class="language-julia hljs">using KernelAbstractions

# Define kernel
@kernel function my_kernel!(y, @Const(x), α)
    i = @index(Global)
    @inbounds y[i] = α * x[i]
end

# Create operation
my_op = KernelOperation(my_kernel!) do y, x, α
    length(y)  # ndrange
end

# Execute on any architecture
my_op(arch, y, x, α)</code></pre><h3 id="Built-in-Operations"><a class="docs-heading-anchor" href="#Built-in-Operations">Built-in Operations</a><a id="Built-in-Operations-1"></a><a class="docs-heading-anchor-permalink" href="#Built-in-Operations" title="Permalink"></a></h3><table><tr><th style="text-align: right">Operation</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right"><code>GPU_ADD_OP</code></td><td style="text-align: right">Element-wise addition</td></tr><tr><td style="text-align: right"><code>GPU_SUB_OP</code></td><td style="text-align: right">Element-wise subtraction</td></tr><tr><td style="text-align: right"><code>GPU_MUL_OP</code></td><td style="text-align: right">Element-wise multiplication</td></tr><tr><td style="text-align: right"><code>GPU_SCALE_OP</code></td><td style="text-align: right">Scalar multiplication</td></tr><tr><td style="text-align: right"><code>GPU_AXPY_OP</code></td><td style="text-align: right">AXPY operation</td></tr></table><h2 id="Distributed-GPU"><a class="docs-heading-anchor" href="#Distributed-GPU">Distributed GPU</a><a id="Distributed-GPU-1"></a><a class="docs-heading-anchor-permalink" href="#Distributed-GPU" title="Permalink"></a></h2><h3 id="TransposableField"><a class="docs-heading-anchor" href="#TransposableField">TransposableField</a><a id="TransposableField-1"></a><a class="docs-heading-anchor-permalink" href="#TransposableField" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Create transposable field for distributed transforms
tf = TransposableField(field)

# Distributed transforms with GPU support
distributed_forward_transform!(tf)
distributed_backward_transform!(tf)

# Access current layout
layout = active_layout(tf)  # XLocal, YLocal, or ZLocal
data = current_data(tf)</code></pre><h3 id="CUDA-Aware-MPI"><a class="docs-heading-anchor" href="#CUDA-Aware-MPI">CUDA-Aware MPI</a><a id="CUDA-Aware-MPI-1"></a><a class="docs-heading-anchor-permalink" href="#CUDA-Aware-MPI" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Check for CUDA-aware MPI
is_cuda_aware = check_cuda_aware_mpi()

# GPU pack/unpack for transposes
gpu_pack_for_transpose!(buffer, data, counts, displs, dim, nranks)
gpu_unpack_from_transpose!(data, buffer, counts, displs, dim, nranks)</code></pre><h2 id="Configuration"><a class="docs-heading-anchor" href="#Configuration">Configuration</a><a id="Configuration-1"></a><a class="docs-heading-anchor-permalink" href="#Configuration" title="Permalink"></a></h2><h3 id="GPU-Config"><a class="docs-heading-anchor" href="#GPU-Config">GPU Config</a><a id="GPU-Config-1"></a><a class="docs-heading-anchor-permalink" href="#GPU-Config" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Initialize GPU configuration
init_gpu_config!()

# Get/set configuration
config = GPU_CONFIG

# Tensor core support (Ampere+)
enable_tensor_cores!()
disable_tensor_cores!()</code></pre><h3 id="Device-Management"><a class="docs-heading-anchor" href="#Device-Management">Device Management</a><a id="Device-Management-1"></a><a class="docs-heading-anchor-permalink" href="#Device-Management" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Ensure correct device context
ensure_device!(arch)

# For multi-GPU
CUDA.device!(rank % CUDA.ndevices())</code></pre><h2 id="Cache-Management"><a class="docs-heading-anchor" href="#Cache-Management">Cache Management</a><a id="Cache-Management-1"></a><a class="docs-heading-anchor-permalink" href="#Cache-Management" title="Permalink"></a></h2><pre><code class="language-julia hljs"># Clear transform caches
clear_gpu_transform_cache!()
clear_batched_fft_cache!()
clear_gpu_mixed_transform_cache!()

# Get cached plan
plan = get_gpu_fft_plan(size, eltype)
plan = get_batched_fft_plan(batch_size, fft_size, eltype)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../timesteppers/">« Timesteppers API</a><a class="docs-footer-nextpage" href="../stochastic_forcing/">Stochastic Forcing API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and <a href="https://julialang.org">Julia</a>. Tarang.jl © 2024 Subhajit Kar.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Sunday 18 January 2026 09:52">Sunday 18 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
